{% extends "base.html" %}
{% block main %}
<div id="main">
    <div id="sidebar">
        <div class="panel">
            <div class="header">
                <span class="col_fade">个人信息</span>
            </div>
            <div class="inner">
                <div class="user_card">
                    <div>
                        <a class="user_avatar" href="{{ url_for('.user_detail', id=user.id) }}">
                            <img src="{{ user.user_image }}" title="{{ user.username }}">
                        </a>
                        <span class="user_name"><a class="dark"
                                                   href="{{ url_for('.user_detail', id=user.id) }}">{{ user.username }}</a></span>
                        <div class="board clearfix">
                            <div class="floor">
                                <span class="big">积分: 0 </span>
                            </div>
                        </div>
                        <div class="space clearfix"></div>
                        <span class="signature">
                            {{ user.signature }}
                        </span>
                    </div>
                </div>

            </div>
        </div>

        <div class="panel">
            <div class="inner">
                <a href="{{ url_for( 'topic.new') }}" id="create_topic_btn">
                    <span class="span-success">发布话题</span>
                </a>
            </div>
        </div>
    </div>


    <div id='content'>
        <div class='panel'>
            <div class='header'>
                <ul class='breadcrumb'>
                    <li><a href='/'>主页</a><span class='divider'>/</span></li>
                    <li class='active'>个人设置</li>
                </ul>
            </div>
            <div class='inner'>
                <form id='setting_form' class='form-horizontal' action='{{ url_for('.change_name', token=token) }}' method='post'>
                    <div class='control-group'>
                        <label class='control-label' for='name'>用户名</label>

                        <div class='controls'>
                            <input class='input-xlarge' id='name' name='name' size='30' type='text'
                                   value="{{ user.username }}"/>
                        </div>
                    </div>

                    <div class='control-group'>
                        <label class='control-label' for='signature'>个性签名</label>

                        <div class='controls'>
                            <textarea class='input-xlarge' id='signature' name='signature' size='30'></textarea>
                        </div>
                    </div>

                    <div class='form-actions'>
                        <input type='submit' class='span-primary submit_btn' data-loading-text="保存中.." value='保存设置'/>
                    </div>
                </form>
            </div>
        </div>

        <div class='panel'>
            <div class='header'>
                <span class='col_fade'>更改密码</span>
            </div>
            <div class='inner'>
                <form id='change_pass_form' class='form-horizontal' action="{{ url_for(".change_pwd",token=token) }}" method='post'>
                    <div class='control-group'>
                        <label class='control-label' for='old_pass'>当前密码</label>

                        <div class='controls'>
                            <input class='input-xlarge' type='password' id='old_pass' name='old_pass' size='30'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label' for='new_pass'>新密码</label>

                        <div class='controls'>
                            <input class='input-xlarge' type='password' id='new_pass' name='new_pass' size='30'/>
                        </div>
                    </div>
                    <div class='form-actions'>
                        <input type='submit' class='span-primary submit_btn' data-loading-text="更改中.." value='更改密码'/>
                    </div>
                </form>
            </div>
        </div>
        <div class="panel">
            <div class="header">
                <span>更新用户头像</span>
            </div>
            <div class="inner">
                    <!--如果用 form 表单上传文件, 一定要指定 enctype="multipart/form-data"-->
                <form class="form-horizontal" action="{{ url_for(".change_avatar") }}" method="post" enctype="multipart/form-data">
                    <div class="control-group">
                        <div class="control-group">
                            <div class="controls">
                                <h5>当前的用户头像</h5>
                                <img src="{{ user.user_image }}" alt="用户头像" class="avatar">
                            </div>
                        </div>
                        <div class="controls">
                            <input id="upload-file" type="file" name="avatar" required>
                            <input id="submit-button" type="submit" class="span-primary" value="上传" />
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


</div>

{% endblock %}

